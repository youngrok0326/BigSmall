model:
  model_name: "Qwen/Qwen2.5-3B"
  gpu_memory_utilization: 0.5
  max_seq_length: 2048
  load_in_4bit: true
  fast_inference: false

wandb:
  enable: true
  project_name: "SMCGRPO"
  run_name: "Real_Qwen2.5-3B"

datasets:
  # - "amc23"
  # - "gsm8k"
  - "math500"

split: "test"

eval:
  repeat_cnt: 1
  sample_cnt: 5
  # Number of prompt groups per batch (each group produces multiple trajectories)
  batch_size_groups: 16
  # Unified number of trajectories per prompt for both default/custom decoding
  num_generations: 16
  max_new_tokens: 1024
  # Which decoding modes to run
  run_default: false
  run_custom: true
  # Use Unsloth+vLLM backend for default decoding
  default_use_vllm: true

default_decode:
  do_sample: true
  temperature: 0.9
  top_p: 1.0
  top_k: 0

custom_decode:
  use_smc: true
  # Sampling controls used inside SMC token selection
  do_sample: true
  temperature: 0.9
  top_p: 1.0
  top_k: 0
  # SMC-specific controls
  smc_beta: 1.0
  smc_warmup_tokens: 50
  smc_confidence_eta: 0.5
  smc_resample_threshold: 1.1
  smc_confidence_window_size: 50
  smc_topk: -1


# Default decoding only:
# uv run python evaluate-decode.py eval.run_default=true eval.run_custom=false wandb.run_name=decode-default
# Custom SMC decoding only:
# uv run python evaluate-decode.py eval.run_default=false eval.run_custom=true wandb.run_name=decode-smc
